{% extends "base.html" %}
{% block title %}Raster: Konservativ vs. OP (jÃ¤hrlich){% endblock %}

{% block content %}
<div class="container">
  <h2>ðŸ§® JÃ¤hrlicher Vergleich: Konventionelle Kosten vs. OP-Kosten</h2>
  <p>Die Grafik zeigt die <b>Jahressumme</b> je Szenario. Unten steht eine kompakte Zusammenfassung.</p>

  <form method="post" class="form-grid">
    <fieldset>
      <legend>OP (einmalig im Jahr)</legend>

      <label>Implantat-Sachkosten (â‚¬)</label>
      <input type="number" step="0.01" name="implant_unit_cost" value="{{ params.implant_unit_cost }}">

      <label>Chirurg (â‚¬)</label>
      <input type="number" step="0.01" name="surgeon_fee" value="{{ params.surgeon_fee }}">

      <label>AnÃ¤sthesie (â‚¬)</label>
      <input type="number" step="0.01" name="anesthesia_fee" value="{{ params.anesthesia_fee }}">

      <label>Verbrauchsmaterial (â‚¬)</label>
      <input type="number" step="0.01" name="consumables_cost" value="{{ params.consumables_cost }}">
    </fieldset>

    <fieldset>
      <legend>Konservativ (pro Monat)</legend>

      <label>Monatsbedarf (Windeln etc.) (â‚¬)</label>
      <input type="number" step="0.01" name="monthly_supplies_cost" value="{{ params.monthly_supplies_cost }}">

      <label>Pflegezeit/Monat (â‚¬)</label>
      <input type="number" step="0.01" name="monthly_care_time_cost" value="{{ params.monthly_care_time_cost }}">
    </fieldset>

    <button type="submit" class="modern-button">Neu berechnen</button>
  </form>
</div>

{% if plot_html %}
<div class="container">
  <h3>Jahres-Grafik</h3>
  <div class="plot-box">
    {{ plot_html|safe }}
  </div>
</div>
{% endif %}

<div class="container summary-box">
  <h3>Zusammenfassung</h3>
  <p>Konservativ (Jahr): <b>{{ "%.2f"|format(totals.cons) }} â‚¬</b></p>
  <p>OP (Jahr): <b>{{ "%.2f"|format(totals.op) }} â‚¬</b></p>
  <p>Î” (OP âˆ’ Konservativ): <b style="color: {{ 'green' if totals.delta < 0 else 'red' if totals.delta > 0 else '#333' }};">
      {{ "%.2f"|format(totals.delta) }} â‚¬</b>
  </p>
</div>

<style>
  .form-grid { display:grid; gap:16px; grid-template-columns: 1fr 1fr; }
  fieldset { border:1px solid #ddd; border-radius:8px; padding:12px; background:#FBFBFF; }
  legend { padding:0 6px; color:#4B0082; font-weight:700; }
  label { display:block; font-weight:600; margin-top:10px; }
  input { width:100%; padding:8px; border:1px solid #CCC; border-radius:6px; background:#F0F0FF; }
  .modern-button { background:#9370DB; color:white; border:none; padding:10px; border-radius:6px; margin-top:8px; cursor:pointer; }
  .modern-button:hover { background:#7B68EE; }

  .plot-box { margin-top: 10px; border: 1px solid #DDD; padding: 10px; border-radius: 8px; background-color: #FAFAFA; }
  .summary-box { background:#F3F3FF; border-radius:8px; padding:16px; }
  @media (max-width: 860px){
    .form-grid { grid-template-columns: 1fr; }
  }
</style>
{% endblock %}
