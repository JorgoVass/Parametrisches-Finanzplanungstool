{% extends "base.html" %}
{% block title %}Kostenvergleich{% endblock %}

{% block content %}
<div class="container">
  <h2>Kostenvergleich</h2>

  <form method="post" class="form-grid">
    <fieldset>
      <legend>Operation (einmalig pro Jahr)</legend>

      <label>Implantat-Kosten (€)</label>
      <input type="number" step="0.01" name="implant_unit_cost" value="{{ params.implant_unit_cost }}">
      <div class="help">Kosten für das Implantat</div>

      <label>Chirurg-Kosten (€)</label>
      <input type="number" step="0.01" name="surgeon_fee" value="{{ params.surgeon_fee }}">
      <div class="help">Kosten des Operateurs</div>

      <label>Anästhesie (€)</label>
      <input type="number" step="0.01" name="anesthesia_fee" value="{{ params.anesthesia_fee }}">
      <div class="help">Kosten für Narkose</div>
    </fieldset>

    <fieldset>
      <legend>Konservative Behandlung (monatlich)</legend>

      <label>Monatsbedarf Material (€)</label>
      <input type="number" step="0.01" name="monthly_supplies_cost" value="{{ params.monthly_supplies_cost }}">
      <div class="help">Z.B. Windeln, Einlagen pro Monat</div>

      <label>Pflegezeit/Monat (€)</label>
      <input type="number" step="0.01" name="monthly_care_time_cost" value="{{ params.monthly_care_time_cost }}">
      <div class="help">Wert der Pflegezeit</div>
    </fieldset>

    <button type="submit" class="modern-button" style="grid-column: 1 / -1;">Neu berechnen</button>
  </form>
</div>

{% if results %}
<div class="container">
  <h3>Jahresvergleich</h3>
  
  <!-- KPI-Boxen -->
  <div class="kpi-grid">
    <div class="kpi-box kpi-purple">
      <div class="kpi-label">Operation</div>
      <div class="kpi-value">{{ "{:,.2f}".format(results.op_year) }} €</div>
    </div>
    
    <div class="kpi-box kpi-red">
      <div class="kpi-label">Konservativ</div>
      <div class="kpi-value">{{ "{:,.2f}".format(results.cons_year) }} €</div>
    </div>
    
    <div class="kpi-box {% if results.delta < 0 %}kpi-success{% else %}kpi-warning{% endif %}">
      <div class="kpi-label">Differenz</div>
      <div class="kpi-value" style="color: {{ 'green' if results.delta < 0 else 'red' }};">
        {{ "{:+,.2f}".format(results.delta) }} €
      </div>
    </div>
  </div>

  <!-- Diagramm -->
  <div class="plot-box">
    {{ plot_html|safe }}
  </div>

  

  <div class="nav-links">
    <a href="{{ url_for('home') }}" class="button-link">⏎ Zurück zur Startseite</a>
  </div>
</div>
{% endif %}

<style>
  .container {
    max-width: 1000px;
    margin: 40px auto;
    padding: 30px;
    background-color: #FFFFFF;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    border-radius: 12px;
  }

  h2, h3 {
    text-align: center;
    color: #002F6C;
    margin-bottom: 15px;
  }

  .form-grid { 
    display: grid; 
    gap: 25px; 
    grid-template-columns: 1fr 1fr; 
    margin-bottom: 30px;
  }
  
  fieldset { 
    border: 2px solid #779FB5; 
    border-radius: 10px; 
    padding: 25px; 
    background: rgba(119, 159, 181, 0.05);
  }
  
  legend { 
    padding: 0 12px; 
    color: #002F6C; 
    font-weight: 700; 
    font-size: 18px;
  }
  
  label { 
    display: block; 
    font-weight: 600; 
    margin-top: 15px; 
    margin-bottom: 6px;
    color: #333;
  }
  
  input { 
    width: 100%; 
    padding: 10px; 
    border: 1px solid #CCC; 
    border-radius: 6px; 
    background: #F0F8FC; 
    font-size: 15px;
    box-sizing: border-box;
  }
  
  .help { 
    font-size: 13px; 
    color: #666; 
    margin-top: 4px; 
    font-style: italic;
  }
  
  .modern-button { 
    background: linear-gradient(135deg, #779FB5 0%, #002F6C 100%);
    color: white; 
    border: none; 
    padding: 14px 24px; 
    border-radius: 8px; 
    font-size: 18px;
    font-weight: bold;
    cursor: pointer; 
    transition: all 0.3s;
    margin-top: 10px;
  }
  
  .modern-button:hover { 
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(119, 159, 181, 0.3);
  }

  .kpi-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    margin: 30px 0;
  }

  .kpi-box {
    background: #F5F5F5;
    border: 2px solid #DDD;
    border-radius: 12px;
    padding: 25px;
    text-align: center;
  }

  .kpi-purple {
    border-color: #779FB5;
    background: #E8F4F8;
  }

  .kpi-red {
    border-color: #FF6B6B;
    background: #FFF0F0;
  }

  .kpi-success {
    border-color: #4CAF50;
    background: #F1F8F4;
  }

  .kpi-warning {
    border-color: #779FB5;  
    background: #E8F4F8;   
  }

  .kpi-label {
    font-size: 14px;
    color: #666;
    font-weight: 600;
    margin-bottom: 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .kpi-value {
    font-size: 26px;
    font-weight: bold;
    color: #002F6C;
    margin-bottom: 8px;
  }

  .plot-box { 
    margin: 30px 0;
    border: 2px solid #DDD; 
    padding: 20px; 
    border-radius: 12px; 
    background-color: #FAFAFA; 
    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
  }

  .nav-links {
    text-align: center;
    margin-top: 30px;
  }

  .button-link {
    background: linear-gradient(135deg, #779FB5 0%, #002F6C 100%);
    color: white;
    padding: 12px 24px;
    border-radius: 8px;
    text-decoration: none;
    font-weight: bold;
    transition: all 0.3s;
    display: inline-block;
  }

  .button-link:hover {
    transform: translateY(-2px);
  }

  @media (max-width: 860px) {
    .form-grid { 
      grid-template-columns: 1fr; 
    }
    .kpi-grid {
      grid-template-columns: 1fr;
    }
  }
</style>
{% endblock %}