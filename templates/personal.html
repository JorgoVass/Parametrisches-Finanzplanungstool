{% extends "base.html" %}
{% block title %}Mitarbeiterverwaltung{% endblock %}

{% block content %}
<div class="container">
    <h2>Mitarbeiterverwaltung</h2>

    <form method="POST" class="form-box">
        <label>Rolle:</label>
        <input type="text" name="rolle" required>

        <label>Monatsgehalt (€):</label>
        <input type="number" name="gehalt" step="0.01" required>

        <div class="grid2">
          <div>
            <label>Startmonat (1–12):</label>
            <input type="number" name="startmonat" min="1" max="12" required>
          </div>
          <div>
            <label>Startjahr:</label>
            <input type="number" name="startjahr" min="1900" max="2100" required>
          </div>
        </div>

        <div class="grid2">
          <div>
            <label>Endmonat (optional, 1–12):</label>
            <input type="number" name="endmonat" min="1" max="12">
          </div>
          <div>
            <label>Endjahr (optional):</label>
            <input type="number" name="endjahr" min="1900" max="2100">
          </div>
        </div>

        <button type="submit" class="modern-button">Hinzufügen</button>
    </form>

    <h3>Aktuelle Mitarbeiter</h3>
    <table class="data-table">
    <thead>
        <tr>
            <th>Rolle</th>
            <th>Gehalt (€)</th>
            <th>Beginn</th>
            <th>Ende</th>
            <th>Aktion</th>
        </tr>
    </thead>
    <tbody>
        {% for m in mitarbeiter %}
        <tr>
            <td>{{ m.rolle }}</td>
            <td>{{ "{:,.2f}".format(m.gehalt) }}</td>
            <td>
                {% if m.startmonat and m.startjahr %}
                  {{ "%02d"|format(m.startmonat) }}/{{ m.startjahr }}
                {% elif m.startmonat %}
                  {{ "%02d"|format(m.startmonat) }}/—
                {% else %}
                  —
                {% endif %}
            </td>
            <td>
                {% if m.endmonat and m.endjahr %}
                  {{ "%02d"|format(m.endmonat) }}/{{ m.endjahr }}
                {% elif m.endmonat or m.endjahr %}
                  {{ m.endmonat if m.endmonat else "—" }}/{{ m.endjahr if m.endjahr else "—" }}
                {% else %}
                  unbefristet
                {% endif %}
            </td>
            <td>
                <form action="{{ url_for('personal_loeschen', index=loop.index0) }}" method="post" style="display:inline;">
                    <button type="submit" class="delete-button" onclick="return confirm('Wirklich löschen?');">🗑️</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

    <div class="nav-links">
        <a href="{{ url_for('home') }}" class="button-link">⏎ Zurück zur Startseite</a>
    </div>
</div>

<style>
  .personal-form {
    background: rgba(119, 159, 181, 0.05);
    border: 2px solid #779FB5;
    border-radius: 12px;
    padding: 25px;
    margin-bottom: 30px;
  }

  .personal-form h3 {
    color: #002F6C;
    margin-bottom: 20px;
  }

  .mitarbeiter-table thead {
    background: linear-gradient(135deg, #779FB5 0%, #002F6C 100%);
    color: white;
  }

  .delete-button {
    background: #E57373;
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .delete-button:hover {
    background: #C62828;
    transform: scale(1.05);
  }
</style>
{% endblock %}